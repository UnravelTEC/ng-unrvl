<h1>Global Settings</h1>

<div *ngIf="gss.client.localscreen == false">
  <h2>Frontend Settings</h2>

  <section>
    <a (click)="fullscreen()">Fullscreen</a>
  </section>
</div>

<h2>Backend Settings</h2>

<section>
  <h2>Data Endpoint</h2>
  <mat-radio-group
    [(ngModel)]="chosenBackendType"
    id="chosenBackend"
    (change)="setEndpoint($event)"
  >
    <div>
      <!-- //show if not dev - oder, egal simma eh selber -->
      <mat-radio-button value="Current Web Endpoint">
        This {{ gss.client.protocol == 'http' ? 'device' : 'server' }} ({{
          gss.client.baseurl
        }})
      </mat-radio-button>
    </div>
    <div>
      <mat-radio-button value="Demo Server">
        UnravelTEC Demo Server
      </mat-radio-button>
    </div>
    <div>
      <mat-radio-button value="Other">
        Other
        {{
          checkedCustomServerURL ? '(' + checkedCustomServerURL + ')' : ''
        }}</mat-radio-button
      >
      <fieldset [disabled]="chosenBackendType != 'Other'">
        <label for="customServerURL">Custom Endpoint URL</label>
        <input type="text" id="customServerURL" [(ngModel)]="customServerURL" />
        <button (click)="checkCustomEndpoint()">Check</button>
        <!-- TODO: Discover LAN -->
      </fieldset>
    </div>
  </mat-radio-group>
</section>

<div class="settingspage" *ngIf="gss.server.type != 'PublicServer'">
  <section>
    <h2>Administration login</h2>
    <table>
      <tr>
        <th><label for="api_username">Username</label></th>
        <td>
          <input type="text" id="api_username" [(ngModel)]="api_username" />
        </td>
      </tr>
      <tr>
        <th><label for="api_pass">Password</label></th>
        <td>
          <input type="text" id="api_pass" [(ngModel)]="api_pass" />
        </td>
      </tr>
      <tr>
        <td>{{ login_status_text }}</td>
        <td style="text-align: right">
          <button (click)="login()">Login</button>
        </td>
      </tr>
    </table>
  </section>
</div>

<div
  class="settingspage"
  *ngIf="auth == 'OK' && gss.server.type == 'Tricorder'"
>
  <section *ngIf="gss.server.hasscreen">
    <h2>
      Screen Brightness:
      <span *ngIf="!bn.disabled"
        >{{ (currentBrightness / 255) * 100 | number: '1.0-0' }}&#8239;%</span
      >
    </h2>
    <app-display-brightness
      (brightnessEvent)="setNewBN($event)"
      #bn
    ></app-display-brightness>
  </section>

  <section>
    <app-network></app-network>
  </section>

  <section class="{{ fanspeed.disabled ? 'hidden' : '' }}">
    <app-fan-speed #fanspeed></app-fan-speed>
  </section>

  <section>
    <h2>System Services</h2>
    <a routerLink="/Settings/Services" routerLinkActive="active"
      >System Services</a
    >
    <hr />

    <h2>System Time</h2>
    <app-system-time></app-system-time>
  </section>

  <section class="center">
    <button (click)="halt()">Shut Down</button>
    <button (click)="reboot()">Reboot</button>
  </section>
</div>

<!-- <button type="submit" class="btn btn-success" (click)="save()">
          Save Settings
        </button>
        <button
          type="submit"
          class="btn btn-success"
          (click)="load()"
          [disabled]="!localStoredSettings"
        >
          Load Settings
        </button>
        <button type="submit" class="btn btn-success" (click)="reset()">
          Reset
        </button>
        <button
          type="submit"
          class="btn btn-success"
          (click)="deleteStoredSettings()"
        >
          Delete Settings
        </button> -->

<div class="settingspage" *ngIf="gss.server.type == 'PublicServer'">
  <section>
    <section>
      <app-influxsettings></app-influxsettings>
    </section>
  </section>
</div>

<div style="margin: 0.5em; text-align: right">
  {{ gitV.branch }}/<a
    href="https://github.com/UnravelTEC/ng-unrvl/commit/{{ gitV.SHA }}"
    >{{ gitV.shortSHA }}</a
  >
  @ <span title="{{ gitV.lastCommitMessage }}">{{ gitV.lastCommitTime }}</span>
  <!-- {{ gitV.lastCommitAuthor }} -->
</div>
